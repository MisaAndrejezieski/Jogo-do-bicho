import{l as f,d as y,E as g}from"./a3x-3kU3.js";import{B as $,m as p}from"./BxZJWESW.js";import{G as b}from"./TWlqzfxS.js";const m=(t,e,r)=>{const n=e.sort((i,l)=>i-l);let o=0;for(const i of n)t=t.slice(0,i+o)+r+t.slice(i+o),o+=r.length;return t},F=f("GameFlux",{state:()=>({modality:"G-SIM",units:[],price:2,lotteries:[],lotteriesId:[],placing:"1",date:new Date().toLocaleDateString("pt-BR"),divisionmoney:null,amountType:"balance",steps:{current:1,total:5,loadingFinishButton:!1},possiblesPrizes:[]}),getters:{$unitsFormatted:t=>{if(t.modality.split("-")[0]!=="G"){if(["DUP"].includes(t.modality.split("-")[1]))return t.units.map(e=>m(e,[2],"-"));if(["TER"].includes(t.modality.split("-")[1]))return t.units.map(e=>m(e,[2,4],"-"));if(["QUA"].includes(t.modality.split("-")[1]))return t.units.map(e=>m(e,[2,4,6],"-"));if(["QUI"].includes(t.modality.split("-")[1]))return t.units.map(e=>m(e,[2,4,6,8],"-"))}return t.units},$bets:function({lotteries:t,lotteriesId:e,date:r,modality:n,placing:o,price:i,divisionmoney:l}){const a=l==="/"?i:i*this.units.length;return t.map((u,s)=>({lottery:u,lotteryId:e[s],modality:`${n==null?void 0:n.toUpperCase()}`,units:this.$unitsFormatted,placing:o,amountTotal:a,unitAmount:this.divisionmoney==="/"?this.price/this.units.length:this.price,date:r}))},$modality(t){return t.modality},$modalityName(t){var e;return(e=p[t.modality])==null?void 0:e.text},$placingFormatted(t){return t.placing==="1"?"1º Prêmio":t.placing==="12"?"1º ao 2º Prêmio":t.placing==="123"?"1º ao 3º Prêmio":t.placing==="12345"?"1º ao 5º Prêmio":t.placing},$divisionMoneyFormatted(t){return t.divisionmoney==="/"?"Para todos os palpites":t.divisionmoney==="*"?"Para cada palpite":""},$digits(){return p[this.$modality].digits||0},$repeat(){return p[this.$modality].repeat},$st(){return p[this.$modality].st||[12345]},$priceTotal(){return this.$bets.reduce((t,e)=>t+e.amountTotal,0)},$enableNextStep(t){const{units:e,price:r,amountType:n,placing:o,divisionmoney:i,lotteries:l}=t,a=["1","12","123","12345"],u=["/","*"];if(t.steps.current===1)return!!p[this.$modality];if(t.steps.current===2)return!!e.length;if(t.steps.current===3)return r>=.1&&a.includes(o)&&!!i&&u.includes(i);if(t.steps.current===4)return!!l.length;if(t.steps.current===5){const s=y().user;return!!this.$bets.length&&!!s&&(s[`${n}`]||0)>=r}else return!1}},actions:{changeModality(t){this.modality=t,this.resetNumber()},changePlacing(t){this.placing=t},resetNumber(){this.units=[],this.lotteries=[],this.lotteriesId=[]},nextStep(){this.steps.current===this.steps.total?this.finishBet():this.steps.current++},backStep(){this.steps.current!==1&&this.steps.current--},preFinishBet(){return{bets:[...this.$bets.map(e=>({lotteryId:e.lotteryId,unitAmount:Number(e.unitAmount).toFixed(2),modality:this.$modalityName.toLowerCase().replaceAll(" ","_"),placing:e.placing,units:e.units.map(r=>r.replaceAll("-",""))}))],amountType:this.amountType}},async finishBet(){var r,n,o,i,l,a,u;if(this.steps.loadingFinishButton)return;this.steps.loadingFinishButton=!0;const e={bets:this.$bets.map(s=>({lotteryId:s.lotteryId,unitAmount:Number(s.unitAmount).toFixed(2),modality:this.$modalityName.toLowerCase().replaceAll(" ","_"),placing:s.placing,units:s.units.map(h=>h.replaceAll("-",""))})),amountType:this.amountType};try{if((await new $().makeBet(e)).type==="success"){const c=y(),d=g();d==null||d.trackEvent({event:b.RELEASE_GAME,event_category:"release_game",event_label:"release_game",value:{value:this.$priceTotal,modality:this.$modality,lottery:this.lotteries,placing:this.placing,palpites:this.units,date:this.date,name:(o=(n=(r=c.user)==null?void 0:r.profile)==null?void 0:n.fullName)==null?void 0:o.split(" ").slice(0,2).join(" "),email:(i=c.user)==null?void 0:i.email,phone:(l=c.user)==null?void 0:l.phone,birthdate:(u=(a=c.user)==null?void 0:a.profile)==null?void 0:u.birthdate}})}}catch(s){throw console.error("Algo deu errado ao tentar realizar a aposta.",s),s}finally{this.steps.loadingFinishButton=!1}this.$reset()}}});export{F as u};
