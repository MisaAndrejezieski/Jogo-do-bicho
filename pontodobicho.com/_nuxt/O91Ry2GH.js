import{_ as q}from"./DoOsWbsk.js";import{_ as N}from"./Bd2QKyF9.js";import{_ as C}from"./CSysSGPk.js";import{k as v,ai as G,l as B,Q as I,$ as b,a2 as s,I as m,a6 as p,a9 as f,a3 as M,u as t,A as L,R as E,V as U,W as D}from"./DSZiQSDz.js";import{o as z,s as S,u as H,a as T,t as Q}from"./gL7-F3v6.js";import{A as W}from"./BKRArTea.js";import{d as J,E as K,e as X,u as Y}from"./a3x-3kU3.js";import{u as Z}from"./BId2YHVf.js";import{G as ee}from"./TWlqzfxS.js";import"./1SZqF1Nt.js";import"./OYiExnqA.js";import"./Cd6k-rI7.js";import"./ak-6Sr7X.js";const se={class:"flex h-full w-full flex-col items-center justify-center bg-white px-4 pb-14 pt-6"},te={class:"mb-4 flex w-full max-w-md items-center justify-start"},oe={class:"w-full max-w-md *:rounded-2xl"},ae={class:"flex w-full flex-col gap-6"},re={class:"flex w-full flex-col items-center"},ne={class:"flex w-full flex-col items-center justify-center text-base"},le=v({__name:"Login",props:{page:{type:Boolean,required:!1,default:!1},redirectTo:{type:String,required:!1}},async setup(x){let o,c;const n=J(),g=K(),y=x,$=z({key:S({message:"O campo email ou cpf precisa ser uma palavra"}).min(1,"O email ou cpf é um campo obrigatório!").refine(a=>{const e=/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(a),i=/^(\d{3}\.\d{3}\.\d{3}-\d{2}|\d{11})$/.test(a);return e||i},{message:"O email ou cpf está em um formato inválido!"}),password:S({message:"O campo senha precisa ser uma palavra"}).min(1,"A senha é um campo obrigatório!")}),{handleSubmit:F,errors:w}=H({validationSchema:Q($)}),{value:l}=T("key"),{value:_}=T("password"),O=new W,{execute:P,status:R}=([o,c]=G(async()=>Z("login",async()=>{var i,u,d,r,k,A,V;const a=l.value.includes("@")?"email":"document";a==="document"&&(l.value=l.value.replace(/\D/g,"")),(await O.login({[a]:l.value,password:_.value},y.redirectTo)).type==="success"&&(g==null||g.trackEvent({event:ee.LOGIN,action:"login",category:"login",label:"login",value:{name:(d=(u=(i=n.user)==null?void 0:i.profile)==null?void 0:u.fullName)==null?void 0:d.split(" ").slice(0,2).join(" "),email:(r=n.user)==null?void 0:r.email,phone:(k=n.user)==null?void 0:k.phone,birthdate:(V=(A=n.user)==null?void 0:A.profile)==null?void 0:V.birthdate}}))},{immediate:!1,server:!1})),o=await o,c(),o),j=B(()=>R.value==="pending"),h=F(async()=>{try{await P()}catch(a){throw a}});return(a,e)=>{const i=q,u=N,d=C;return b(),I("div",se,[s("div",te,[m(u,{to:"/"},{default:p(()=>[m(i,{class:"!px-0 !py-4 !text-blue",variant:"text",icon:"material-symbols:arrow-back-ios-new-rounded"},{default:p(()=>e[3]||(e[3]=[f(" Voltar ")])),_:1})]),_:1})]),s("div",oe,[s("div",ae,[e[8]||(e[8]=s("div",{class:"flex flex-col gap-2"},[s("h1",{class:"text-xl font-semibold leading-10 text-gray-900 md:text-3xl"},[f(" Bem-vindo(a) de volta ao "),s("span",{class:"text-blue-500"},"Ponto do Bicho")]),s("span",{class:"text-gray-900"},"Faça login e acesse seu perfil:")],-1)),s("form",{onSubmit:e[2]||(e[2]=M((...r)=>t(h)&&t(h)(...r),["prevent"])),class:"flex w-full flex-col gap-4"},[m(d,{"error-message":t(w).key,autocomplete:"true",class:"w-full",modelValue:t(l),"onUpdate:modelValue":e[0]||(e[0]=r=>L(l)?l.value=r:null),placeholder:"Email ou CPF",name:"key"},null,8,["error-message","modelValue"]),m(d,{type:"password","error-message":t(w).password,class:"w-full",modelValue:t(_),"onUpdate:modelValue":e[1]||(e[1]=r=>L(_)?_.value=r:null),placeholder:"Senha",name:"password"},null,8,["error-message","modelValue"]),m(i,{class:"mt-2","is-disabled":!!Object.keys(t(w)).length,loading:t(j),type:"submit"},{default:p(()=>e[4]||(e[4]=[f(" Entrar ")])),_:1},8,["is-disabled","loading"])],32),s("div",re,[m(u,{to:"/esqueci-minha-senha",class:"text-base text-yellow underline"},{default:p(()=>e[5]||(e[5]=[f("Esqueceu sua senha?")])),_:1})]),s("div",ne,[e[7]||(e[7]=s("p",{class:"text-gray-900"},"Ainda não tem uma conta?",-1)),m(u,{to:"/registrar",class:"text-yellow underline"},{default:p(()=>e[6]||(e[6]=[f("Registrar-se")])),_:1})])])])])}}}),ie=v({__name:"Login",setup(x){const o=X(),c=B(()=>typeof o.query.redirectTo=="string"?{redirectTo:o.query.redirectTo}:{});return(n,g)=>{const y=le;return b(),E(y,U(D(t(c))),null,16)}}}),he=v({__name:"entrar",setup(x){return Y({title:"Entrar",meta:[{name:"robots",content:"index"},{name:"description",content:"Faça login na Ponto do Bicho."}]}),(o,c)=>{const n=ie;return b(),E(n)}}});export{he as default};
